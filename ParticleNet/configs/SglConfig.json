{
  "description": "Single-run training configuration for ParticleNet multi-class training",
  "version": "1.0",

  "training_parameters": {
    "train_folds": [0, 1, 2],
    "valid_folds": [3],
    "test_folds": [4],
    "max_epochs": 81,
    "batch_size": 128,
    "dropout_p": 0.4,
    "early_stopping_patience": 7,
    "loss_type": "weighted_ce",
    "balance_weights": true,
    "max_events_per_fold_per_class": 50000,
    "comment": "train_folds for training data, valid_folds for validation/early stopping, test_folds for final evaluation. max_events_per_fold_per_class limits memory usage and speeds up training while preserving physics through weight rescaling."
  },

  "model_config": {
    "default_model": "ParticleNet",
    "nNodes": 128,
    "comment": "Model architecture options: ParticleNet, ParticleNetV2, OptimizedParticleNet, EfficientParticleNet, EnhancedParticleNet, HierarchicalParticleNet"
  },

  "optimization_config": {
    "optimizer": "Adam",
    "initLR": 0.001,
    "weight_decay": 0.0001,
    "scheduler": "ExponentialLR",
    "comment": "Valid optimizers: Adam, RMSprop, Adadelta. Valid schedulers: StepLR, ExponentialLR, CyclicLR, ReduceLROnPlateau"
  },

  "background_config": {
    "mode": "groups",
    "background_groups": {
      "nonprompt": ["TTLL_powheg"],
      "diboson": ["WZTo3LNu_amcatnlo", "ZZTo4L_powheg"],
      "ttX": ["TTZToLLNuNu", "tZq"]
    },
    "backgrounds_list": [],
    "comment": "mode: 'groups' or 'individual'. If 'groups', use background_groups (physics-motivated grouping). If 'individual', use backgrounds_list (each background as separate class)."
  },

  "dataset_config": {
    "use_bjets": true,
    "signal_prefix": "TTToHcToWAToMuMu-",
    "background_prefix": "Skim_TriLep_",
    "comment": "use_bjets=true means use dataset_bjets with separate b-jet particles. use_bjets=false means standard dataset."
  },

  "system_config": {
    "device": "cuda",
    "pilot": false,
    "debug": false,
    "comment": "device: 'cpu', 'cuda', or 'cuda:X' for specific GPU. pilot=true uses small pilot datasets for testing."
  },

  "output_config": {
    "results_dir": "experiment",
    "comment": "results_dir: 'results' or 'results_bjets'. Automatically set based on dataset_config.use_bjets if not explicitly overridden."
  }
}
