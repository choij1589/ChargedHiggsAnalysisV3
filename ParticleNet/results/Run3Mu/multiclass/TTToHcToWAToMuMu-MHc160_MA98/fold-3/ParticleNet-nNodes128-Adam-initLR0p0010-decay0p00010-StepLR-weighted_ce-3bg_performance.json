{
  "model_name": "ParticleNet-nNodes128-Adam-initLR0p0010-decay0p00010-StepLR-weighted_ce-3bg",
  "signal_sample": "TTToHcToWAToMuMu-MHc160_MA98",
  "channel": "Run3Mu",
  "fold": 3,
  "pilot_mode": false,
  "training_config": {
    "model_type": "ParticleNet",
    "num_classes": 4,
    "use_groups": false,
    "optimizer": "Adam",
    "scheduler": "StepLR",
    "loss_type": "weighted_ce",
    "initial_lr": 0.001,
    "weight_decay": 0.0001,
    "dropout_p": 0.25,
    "max_epochs": 81,
    "batch_size": 1024
  },
  "background_info": {
    "mode": "individual",
    "num_backgrounds": 3,
    "backgrounds": [
      "TTLL_powheg",
      "WZTo3LNu_amcatnlo",
      "TTZToLLNuNu"
    ]
  },
  "training_results": {
    "model_type": "ParticleNet",
    "num_classes": 4,
    "use_groups": false,
    "background_groups": null,
    "epochs_completed": 54,
    "total_training_time": 7397.0308384895325,
    "avg_epoch_time": 136.98205256462097,
    "best_valid_loss": 0.9580052201786349,
    "early_stopped": true,
    "model_parameters": 272807,
    "final_memory_mb": 7808.80078125,
    "training_history": [
      {
        "epoch": 0,
        "train_loss": 1.2379871560078042,
        "train_acc": 0.4424566626548767,
        "valid_loss": 1.1179810344211516,
        "valid_acc": 0.514701247215271,
        "epoch_time": 257.96182799339294,
        "memory_mb": 7786.36328125,
        "cpu_percent": 0.0
      },
      {
        "epoch": 1,
        "train_loss": 1.1319476908662407,
        "train_acc": 0.5101351737976074,
        "valid_loss": 1.1052562844368718,
        "valid_acc": 0.5189684629440308,
        "epoch_time": 148.92015314102173,
        "memory_mb": 7800.5703125,
        "cpu_percent": 205.5
      },
      {
        "epoch": 2,
        "train_loss": 1.1068535395363133,
        "train_acc": 0.5229412317276001,
        "valid_loss": 1.0797456464459818,
        "valid_acc": 0.5281518697738647,
        "epoch_time": 126.20235323905945,
        "memory_mb": 7803.33203125,
        "cpu_percent": 226.3
      },
      {
        "epoch": 3,
        "train_loss": 1.0936744653878092,
        "train_acc": 0.5290742516517639,
        "valid_loss": 1.0660275124734448,
        "valid_acc": 0.5378166437149048,
        "epoch_time": 174.2868800163269,
        "memory_mb": 7804.68359375,
        "cpu_percent": 177.6
      },
      {
        "epoch": 4,
        "train_loss": 1.083786619644539,
        "train_acc": 0.5348463654518127,
        "valid_loss": 1.0569672671056562,
        "valid_acc": 0.5423745512962341,
        "epoch_time": 147.09964990615845,
        "memory_mb": 7804.91796875,
        "cpu_percent": 196.6
      },
      {
        "epoch": 5,
        "train_loss": 1.076000733201911,
        "train_acc": 0.5379903316497803,
        "valid_loss": 1.0568150161735472,
        "valid_acc": 0.5430600047111511,
        "epoch_time": 138.7140452861786,
        "memory_mb": 7808.05078125,
        "cpu_percent": 207.4
      },
      {
        "epoch": 6,
        "train_loss": 1.0713010660740507,
        "train_acc": 0.540086567401886,
        "valid_loss": 1.054943306792167,
        "valid_acc": 0.5464476943016052,
        "epoch_time": 185.7840859889984,
        "memory_mb": 7809.55078125,
        "cpu_percent": 168.7
      },
      {
        "epoch": 7,
        "train_loss": 1.064359377412235,
        "train_acc": 0.5448412299156189,
        "valid_loss": 1.044287575348731,
        "valid_acc": 0.5514774918556213,
        "epoch_time": 148.65033102035522,
        "memory_mb": 7809.55078125,
        "cpu_percent": 195.3
      },
      {
        "epoch": 8,
        "train_loss": 1.0610569765587814,
        "train_acc": 0.5454441905021667,
        "valid_loss": 1.0349175862727626,
        "valid_acc": 0.555787205696106,
        "epoch_time": 190.50782680511475,
        "memory_mb": 7809.55078125,
        "cpu_percent": 166.0
      },
      {
        "epoch": 9,
        "train_loss": 1.0542262649001861,
        "train_acc": 0.5500326752662659,
        "valid_loss": 1.030235480877661,
        "valid_acc": 0.5576287508010864,
        "epoch_time": 145.37616729736328,
        "memory_mb": 7809.55078125,
        "cpu_percent": 200.7
      },
      {
        "epoch": 10,
        "train_loss": 1.0494081304520786,
        "train_acc": 0.5516436100006104,
        "valid_loss": 1.0237110833967886,
        "valid_acc": 0.5605327486991882,
        "epoch_time": 151.65227627754211,
        "memory_mb": 7809.55078125,
        "cpu_percent": 192.8
      },
      {
        "epoch": 11,
        "train_loss": 1.0462143120645475,
        "train_acc": 0.5548083186149597,
        "valid_loss": 1.0279880142019642,
        "valid_acc": 0.5601262450218201,
        "epoch_time": 180.43697118759155,
        "memory_mb": 7809.55078125,
        "cpu_percent": 173.5
      },
      {
        "epoch": 12,
        "train_loss": 1.0425933562740892,
        "train_acc": 0.5568159818649292,
        "valid_loss": 1.0172943256555065,
        "valid_acc": 0.5666284561157227,
        "epoch_time": 138.48491883277893,
        "memory_mb": 7809.55078125,
        "cpu_percent": 208.2
      },
      {
        "epoch": 13,
        "train_loss": 1.0380356036314444,
        "train_acc": 0.5592190623283386,
        "valid_loss": 1.0165810262964619,
        "valid_acc": 0.5672206878662109,
        "epoch_time": 187.58414840698242,
        "memory_mb": 7809.55078125,
        "cpu_percent": 167.6
      },
      {
        "epoch": 14,
        "train_loss": 1.036267703988639,
        "train_acc": 0.5588414669036865,
        "valid_loss": 1.0107730045433967,
        "valid_acc": 0.5696059465408325,
        "epoch_time": 143.30890107154846,
        "memory_mb": 7809.55078125,
        "cpu_percent": 201.2
      },
      {
        "epoch": 15,
        "train_loss": 1.0325427008610146,
        "train_acc": 0.5597153902053833,
        "valid_loss": 1.0045801934696013,
        "valid_acc": 0.571747899055481,
        "epoch_time": 149.99133896827698,
        "memory_mb": 7809.55078125,
        "cpu_percent": 192.9
      },
      {
        "epoch": 16,
        "train_loss": 1.0283609473404765,
        "train_acc": 0.5630066394805908,
        "valid_loss": 1.0057992065145123,
        "valid_acc": 0.5715199708938599,
        "epoch_time": 182.83555555343628,
        "memory_mb": 7809.55078125,
        "cpu_percent": 174.5
      },
      {
        "epoch": 17,
        "train_loss": 1.027983248400755,
        "train_acc": 0.5633203387260437,
        "valid_loss": 0.9984766725570925,
        "valid_acc": 0.5764039158821106,
        "epoch_time": 141.86331629753113,
        "memory_mb": 7809.55078125,
        "cpu_percent": 204.5
      },
      {
        "epoch": 18,
        "train_loss": 1.02404513362409,
        "train_acc": 0.5640654563903809,
        "valid_loss": 0.9933796005864297,
        "valid_acc": 0.5798481106758118,
        "epoch_time": 175.81517720222473,
        "memory_mb": 7809.55078125,
        "cpu_percent": 177.5
      },
      {
        "epoch": 19,
        "train_loss": 1.0225429868831688,
        "train_acc": 0.565841555595398,
        "valid_loss": 0.9929203443950222,
        "valid_acc": 0.5789695978164673,
        "epoch_time": 127.59054636955261,
        "memory_mb": 7809.55078125,
        "cpu_percent": 223.0
      },
      {
        "epoch": 20,
        "train_loss": 1.0208207474035376,
        "train_acc": 0.5672566294670105,
        "valid_loss": 0.988939649155063,
        "valid_acc": 0.581200897693634,
        "epoch_time": 134.5740716457367,
        "memory_mb": 7809.55078125,
        "cpu_percent": 212.3
      },
      {
        "epoch": 21,
        "train_loss": 1.0175754265958856,
        "train_acc": 0.5693373084068298,
        "valid_loss": 0.9878051319429951,
        "valid_acc": 0.581160843372345,
        "epoch_time": 167.90436673164368,
        "memory_mb": 7809.55078125,
        "cpu_percent": 183.1
      },
      {
        "epoch": 22,
        "train_loss": 1.0148798040315217,
        "train_acc": 0.569561243057251,
        "valid_loss": 0.984517406071386,
        "valid_acc": 0.5811575055122375,
        "epoch_time": 131.80877900123596,
        "memory_mb": 7809.55078125,
        "cpu_percent": 215.5
      },
      {
        "epoch": 23,
        "train_loss": 1.0141536189394504,
        "train_acc": 0.5691755414009094,
        "valid_loss": 0.9810897083051743,
        "valid_acc": 0.5847346186637878,
        "epoch_time": 158.48748016357422,
        "memory_mb": 7809.17578125,
        "cpu_percent": 194.1
      },
      {
        "epoch": 24,
        "train_loss": 1.0126028782179375,
        "train_acc": 0.5690131187438965,
        "valid_loss": 0.9824872689862405,
        "valid_acc": 0.5828266739845276,
        "epoch_time": 126.36397552490234,
        "memory_mb": 7808.80078125,
        "cpu_percent": 225.1
      },
      {
        "epoch": 25,
        "train_loss": 1.0107409049148988,
        "train_acc": 0.5726249814033508,
        "valid_loss": 0.9784410855462474,
        "valid_acc": 0.5860511660575867,
        "epoch_time": 171.45662903785706,
        "memory_mb": 7808.80078125,
        "cpu_percent": 181.2
      },
      {
        "epoch": 26,
        "train_loss": 1.010817181496393,
        "train_acc": 0.5719053745269775,
        "valid_loss": 0.9820650479485912,
        "valid_acc": 0.5830376744270325,
        "epoch_time": 130.6423897743225,
        "memory_mb": 7808.80078125,
        "cpu_percent": 219.4
      },
      {
        "epoch": 27,
        "train_loss": 1.0080342832065763,
        "train_acc": 0.5733494162559509,
        "valid_loss": 0.9765538140650718,
        "valid_acc": 0.5858145356178284,
        "epoch_time": 124.84812760353088,
        "memory_mb": 7808.80078125,
        "cpu_percent": 228.1
      },
      {
        "epoch": 28,
        "train_loss": 1.0065806593213762,
        "train_acc": 0.5732907056808472,
        "valid_loss": 0.9814731185474703,
        "valid_acc": 0.5826563239097595,
        "epoch_time": 164.56444644927979,
        "memory_mb": 7808.80078125,
        "cpu_percent": 189.0
      },
      {
        "epoch": 29,
        "train_loss": 1.0038288295769893,
        "train_acc": 0.5745236277580261,
        "valid_loss": 0.9740702495459588,
        "valid_acc": 0.5872223973274231,
        "epoch_time": 118.10888123512268,
        "memory_mb": 7808.80078125,
        "cpu_percent": 238.7
      },
      {
        "epoch": 30,
        "train_loss": 1.0040568171762954,
        "train_acc": 0.5754488110542297,
        "valid_loss": 0.972488974371264,
        "valid_acc": 0.5870547890663147,
        "epoch_time": 145.21202874183655,
        "memory_mb": 7808.80078125,
        "cpu_percent": 209.8
      },
      {
        "epoch": 31,
        "train_loss": 1.0023230350985914,
        "train_acc": 0.5755162835121155,
        "valid_loss": 0.9751451327916114,
        "valid_acc": 0.5864453911781311,
        "epoch_time": 110.19212889671326,
        "memory_mb": 7808.80078125,
        "cpu_percent": 250.2
      },
      {
        "epoch": 32,
        "train_loss": 1.0029411507921726,
        "train_acc": 0.5751199126243591,
        "valid_loss": 0.9711326701987174,
        "valid_acc": 0.5877935290336609,
        "epoch_time": 115.16025042533875,
        "memory_mb": 7808.80078125,
        "cpu_percent": 243.2
      },
      {
        "epoch": 33,
        "train_loss": 1.0012482389682482,
        "train_acc": 0.5756639242172241,
        "valid_loss": 0.9728664001149516,
        "valid_acc": 0.588845431804657,
        "epoch_time": 145.16623950004578,
        "memory_mb": 7808.80078125,
        "cpu_percent": 207.0
      },
      {
        "epoch": 34,
        "train_loss": 0.9997895236442736,
        "train_acc": 0.5769064426422119,
        "valid_loss": 0.9710382328879449,
        "valid_acc": 0.5894505381584167,
        "epoch_time": 107.59208726882935,
        "memory_mb": 7808.80078125,
        "cpu_percent": 256.3
      },
      {
        "epoch": 35,
        "train_loss": 0.9984771196915656,
        "train_acc": 0.5771252512931824,
        "valid_loss": 0.9689568608037887,
        "valid_acc": 0.5903031826019287,
        "epoch_time": 141.77963733673096,
        "memory_mb": 7808.80078125,
        "cpu_percent": 213.2
      },
      {
        "epoch": 36,
        "train_loss": 0.9974393532389686,
        "train_acc": 0.5782442092895508,
        "valid_loss": 0.9675833948196904,
        "valid_acc": 0.588267982006073,
        "epoch_time": 115.32340025901794,
        "memory_mb": 7808.80078125,
        "cpu_percent": 242.2
      },
      {
        "epoch": 37,
        "train_loss": 0.9962139151343444,
        "train_acc": 0.577854573726654,
        "valid_loss": 0.968096481696252,
        "valid_acc": 0.5894986391067505,
        "epoch_time": 97.15003299713135,
        "memory_mb": 7808.80078125,
        "cpu_percent": 270.9
      },
      {
        "epoch": 38,
        "train_loss": 0.995559983560685,
        "train_acc": 0.5791059732437134,
        "valid_loss": 0.966171306948508,
        "valid_acc": 0.5905555486679077,
        "epoch_time": 124.33127903938293,
        "memory_mb": 7808.80078125,
        "cpu_percent": 233.0
      },
      {
        "epoch": 39,
        "train_loss": 0.9964025067348107,
        "train_acc": 0.5798397660255432,
        "valid_loss": 0.9650868105311547,
        "valid_acc": 0.5916646718978882,
        "epoch_time": 106.3365626335144,
        "memory_mb": 7808.80078125,
        "cpu_percent": 257.5
      },
      {
        "epoch": 40,
        "train_loss": 0.994912556907376,
        "train_acc": 0.5792391896247864,
        "valid_loss": 0.965026581479657,
        "valid_acc": 0.5923709869384766,
        "epoch_time": 131.92799186706543,
        "memory_mb": 7808.80078125,
        "cpu_percent": 222.3
      },
      {
        "epoch": 41,
        "train_loss": 0.9943069256320387,
        "train_acc": 0.5786508321762085,
        "valid_loss": 0.964959561344116,
        "valid_acc": 0.5909476280212402,
        "epoch_time": 97.83631253242493,
        "memory_mb": 7808.80078125,
        "cpu_percent": 267.1
      },
      {
        "epoch": 42,
        "train_loss": 0.9929186771897709,
        "train_acc": 0.5795835256576538,
        "valid_loss": 0.9633209258317947,
        "valid_acc": 0.5938054919242859,
        "epoch_time": 102.91704654693604,
        "memory_mb": 7808.80078125,
        "cpu_percent": 262.1
      },
      {
        "epoch": 43,
        "train_loss": 0.9925097223757362,
        "train_acc": 0.5805983543395996,
        "valid_loss": 0.9624165935862449,
        "valid_acc": 0.5935882925987244,
        "epoch_time": 134.1527614593506,
        "memory_mb": 7808.80078125,
        "cpu_percent": 220.1
      },
      {
        "epoch": 44,
        "train_loss": 0.9928426901165511,
        "train_acc": 0.581657350063324,
        "valid_loss": 0.9634123430136712,
        "valid_acc": 0.5938166975975037,
        "epoch_time": 100.38151550292969,
        "memory_mb": 7808.80078125,
        "cpu_percent": 268.5
      },
      {
        "epoch": 45,
        "train_loss": 0.9900708804611399,
        "train_acc": 0.5820739269256592,
        "valid_loss": 0.9612768547188851,
        "valid_acc": 0.5928223133087158,
        "epoch_time": 118.96368098258972,
        "memory_mb": 7808.80078125,
        "cpu_percent": 236.4
      },
      {
        "epoch": 46,
        "train_loss": 0.9888492635652131,
        "train_acc": 0.5808824896812439,
        "valid_loss": 0.9580052201786349,
        "valid_acc": 0.5951391458511353,
        "epoch_time": 98.13814115524292,
        "memory_mb": 7808.80078125,
        "cpu_percent": 265.7
      },
      {
        "epoch": 47,
        "train_loss": 0.988797717735547,
        "train_acc": 0.5831896066665649,
        "valid_loss": 0.9599083138089026,
        "valid_acc": 0.5957687497138977,
        "epoch_time": 124.68321776390076,
        "memory_mb": 7808.80078125,
        "cpu_percent": 226.4
      },
      {
        "epoch": 48,
        "train_loss": 0.9902793175699998,
        "train_acc": 0.582261323928833,
        "valid_loss": 0.9625883885929661,
        "valid_acc": 0.5924684405326843,
        "epoch_time": 89.85828232765198,
        "memory_mb": 7808.80078125,
        "cpu_percent": 272.0
      },
      {
        "epoch": 49,
        "train_loss": 0.9866207021625102,
        "train_acc": 0.5818350315093994,
        "valid_loss": 0.9596350510274211,
        "valid_acc": 0.5947917699813843,
        "epoch_time": 93.2727267742157,
        "memory_mb": 7808.80078125,
        "cpu_percent": 275.4
      },
      {
        "epoch": 50,
        "train_loss": 0.9885369340578715,
        "train_acc": 0.5825185775756836,
        "valid_loss": 0.9628930726358967,
        "valid_acc": 0.5934610962867737,
        "epoch_time": 127.69751763343811,
        "memory_mb": 7808.80078125,
        "cpu_percent": 226.7
      },
      {
        "epoch": 51,
        "train_loss": 0.9866133864854231,
        "train_acc": 0.5835212469100952,
        "valid_loss": 0.9606855367460558,
        "valid_acc": 0.592373251914978,
        "epoch_time": 94.583811044693,
        "memory_mb": 7808.80078125,
        "cpu_percent": 275.9
      },
      {
        "epoch": 52,
        "train_loss": 0.9874648642139274,
        "train_acc": 0.5824159383773804,
        "valid_loss": 0.961340198593755,
        "valid_acc": 0.5930265784263611,
        "epoch_time": 114.85899591445923,
        "memory_mb": 7808.80078125,
        "cpu_percent": 232.1
      },
      {
        "epoch": 53,
        "train_loss": 0.9857871904760516,
        "train_acc": 0.5840427875518799,
        "valid_loss": 0.9590693226745052,
        "valid_acc": 0.5933220982551575,
        "epoch_time": 87.68957185745239,
        "memory_mb": 7808.80078125,
        "cpu_percent": 280.2
      }
    ],
    "test_loss": 0.9619942085586325,
    "test_accuracy": 0.5985326766967773,
    "bjet_subset_results": {
      "train_results": {
        "has_bjet_events": true,
        "statistics": {
          "total_events": 365252,
          "bjet_events": 205080,
          "bjet_event_fraction": 0.5614753649535116,
          "avg_bjets_per_bjet_event": 1.2291398478642481,
          "total_bjets": 252072
        },
        "bjet_subset_loss": 0.8853242094837018,
        "bjet_subset_accuracy": 0.6223325133323669,
        "full_train_loss": 0.9257531249556554,
        "full_train_accuracy": 0.6146860718727112,
        "accuracy_delta": 0.007646441459655762,
        "loss_delta": -0.0404289154719536,
        "bjet_event_count": 205080,
        "total_train_count": 365252
      },
      "test_results": {
        "has_bjet_events": true,
        "statistics": {
          "total_events": 139526,
          "bjet_events": 75465,
          "bjet_event_fraction": 0.540866935194874,
          "avg_bjets_per_bjet_event": 1.215848406546081,
          "total_bjets": 91754
        },
        "bjet_subset_loss": 0.9196813187083682,
        "bjet_subset_accuracy": 0.6041903495788574,
        "full_test_loss": 0.9619941946363797,
        "full_test_accuracy": 0.5985326766967773,
        "accuracy_delta": 0.005657672882080078,
        "loss_delta": -0.04231287592801147,
        "bjet_event_count": 75465,
        "total_test_count": 139526
      },
      "train_test_comparison": {
        "bjet_accuracy_gap": 0.01814216375350952,
        "bjet_loss_gap": -0.03435710922466639
      }
    }
  }
}